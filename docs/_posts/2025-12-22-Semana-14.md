---
title: "Dataset con variable intermedia"
categories:
  - Weblog
tags:
  - Carla
  - Brain
  - PythonAPI
  - Steer
  - Control
---

Esta semana el objetivo era el de crear un nuevo dataset, balancearlo en base a su distribución estadística, y entrenar un modelo con PilotNet. Esta última no ha sido del todo posible, pues el servidor Libélula sigue sin estar operativo.

## Creación de un nuevo dataset

Se ha creado un dataset nuevo, en varios escenarios del simulador carla, controlando con los actuadores la aceleración (throttle), el freno (brake) y la velocidad de giro (steer_rate). Este último parámetro, como se intrudujo la semana pasada, se trata de una variable intermedia a partir de la cual se obtiene el actuador steer (ángulo/desmpazamiento de giro del volante). 

Inicialmente se ha creado un dataset de 17k muestras, pues por el momento no es posible entrenar un conjunto de datos mayor por las limitaciones del equipo y por la inactividad del servidor.

Para el balanceo del dataset, se ha normalizado a área 1 y, posteriormente, se han ido eliminando bins hasta obtener una forma lo más parecida posible a la función gaussiana calculada con la media y desviación típica del propio conjunto de datos. A continuación, se muestra la FDP del conjunto de muestras antes y después del balanceo, respectivamente:

<figure class="align-center" style="max-width: 100%">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/hist_inicial.png" alt="Histograma inicial">
</figure>

<figure class="align-center" style="max-width: 100%">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/hist_balanceado.png" alt="Histograma dataset balanceado">
</figure>

## Entrenamiento y simulación para predecir STEER

Como se ha comentado antes, no se ha podido entrenar un modelo con PilotNet, ni simular posteriormente con el modelo que pueda predecir el valor de steer_rate.

Sí se ha realizado, con las limitaciones que tiene el equipo actual, un entrenamiento con 10k muestras. No obstante, se tiene en cuenta que el número de muestras es muy bajo e insuficiente como para poder entrenar un modelo funcional.

